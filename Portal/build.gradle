apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: 'war'
apply plugin: 'eclipse'
apply plugin: 'jetty'

sourceCompatibility = 1.5

version = '2.0.5-SNAPSHOT'

dependencies {
 compile group: 'net.atos.tapestry', name: 'tapestry5-kawwa-components', version: '2.0.5-SNAPSHOT'
 compile group: 'commons-logging', name: 'commons-logging', version: '1.1.1'
 compile group: 'com.google.api-client', name: 'google-api-client', version: '1.10.3-beta'
 compile group: 'javax.mail', name: 'mail', version: '1.4.3'
 compile group: 'xerces', name: 'xerces', version: '2.4.0'
 compile group: 'org.apache.tapestry', name: 'tapestry-core', version: '5.3.7'
 providedCompile  group: 'javax.servlet', name: 'servlet-api', version: '2.5'
 
 
 testCompile group: 'junit', name: 'junit', version: '4.+'
 testCompile 'org.codehaus.groovy:groovy-all:2.0.5'
}

repositories {
	mavenCentral()
	mavenLocal()
	maven {url 'http://nexus.devlab722.net/nexus/content/repositories/snapshots/'}
}

task copyTapestryDocs(type: Copy)  {
	from '../kawwa2-tapestry/target/site/apidocs'
	into 'src/main/webapp/apis/tapestry'
}
task copyAngularDocs(type: Copy) {
	
}
task deleteTapestryDocs(type: Delete) {
	delete 'src/main/webapp/apis/tapestry/'
}
task deleteAngularDocs(type: Delete) {
	delete 'src/main/webapp/apis/angular/'	
}
task copyCSSTheme(type: Copy) {
	
}


task compileTapestryLib(type: Exec)  {
    workingDir = file('../kawwa2-tapestry')
	commandLine 'cmd', '/c', 'mvn', 'clean', 'install', '-DskipTests'
    standardOutput = new ByteArrayOutputStream()
}

task compileAngularLib <<  {
	
}

copyTapestryDocs.dependsOn("compileTapestryLib", "deleteTapestryDocs")
copyAngularDocs.dependsOn("compileAngularLib", "deleteAngularDocs")


processResources.dependsOn("copyTapestryLib")
processResources.dependsOn("copyAngularLib")
processResources.dependsOn("copyCSSTheme")